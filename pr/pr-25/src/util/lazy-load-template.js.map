{"version":3,"file":"lazy-load-template.js","sourceRoot":"","sources":["../../../src/util/lazy-load-template.ts"],"names":[],"mappings":"AACA,OAAO,EACL,SAAS,EACT,SAAS,GAKV,MAAM,kBAAkB,CAAC;AAE1B,MAAM,QAAQ,GAAG,IAAI,OAAO,EAAE,CAAC;AAc/B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA8BG;AACH,MAAM,OAAO,gBAAiB,SAAQ,SAAS;IAC7C,YAAY,QAAkB;QAC5B,KAAK,CAAC,QAAQ,CAAC,CAAC;IAClB,CAAC;IAED,MAAM,CAAC,IAAU,EAAE,CAAC,aAAa,EAAE,KAAK,CAA4B;QAClE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC;YACxB,aAAa,EAAE,CAAC;YAChB,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QACrB,CAAC;QACD,OAAO,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;IAC3C,CAAC;IAED,MAAM,CAAC,cAAmC,EAAE,KAA2B;QACrE,OAAO,KAAK,EAAE,CAAC;IACjB,CAAC;CACF;AAED,MAAM,CAAC,MAAM,gBAAgB,GAAG,SAAS,CAAC,gBAAgB,CAAC,CAAC","sourcesContent":["import type { TemplateResult } from 'lit';\nimport {\n  Directive,\n  directive,\n  DirectiveParameters,\n  DirectiveResult,\n  Part,\n  PartInfo,\n} from 'lit/directive.js';\n\nconst resolved = new WeakSet();\n\n/**\n * A LazyLoadedTemplate is a wrapper for a TemplateResult\n * lazy-loaded with the `lazyLoadTemplate` function.\n *\n * It can be used in an html`` block, eg.\n *\n * html`\n *   ${this.radioPlayerTemplate}  <-- see `radioPlayerTemplate` example below\n * `\n */\nexport type LazyLoadedTemplate = DirectiveResult<typeof LazyLoadTemplate>;\n\n/**\n * This utility let's you asynchronously load a webcomponent.\n *\n * Derived from an example shown in:\n * https://www.youtube.com/watch?v=x9YDQUJx2uw\n *\n * Example use:\n *\n * get radioPlayerTemplate(): LazyLoadedTemplate {\n *   return lazyLoadTemplate(\n *     async (): Promise<void> => {\n *       await import('./players/radio-player');\n *     },\n *     (): TemplateResult => {\n *       return html`\n *         <radio-player\n *           .metadataResponse=${this.metadataResponse}\n *           .browserHistoryHandler=${this.browserHistoryHandler}\n *         >\n *         </radio-player>\n *       `;\n *     },\n *   );\n * }\n *\n * ...\n *\n * return html`\n *   ${this.radioPlayerTemplate}\n * `\n */\nexport class LazyLoadTemplate extends Directive {\n  constructor(partInfo: PartInfo) {\n    super(partInfo);\n  }\n\n  update(part: Part, [importPromise, value]: DirectiveParameters<this>) {\n    if (!resolved.has(part)) {\n      importPromise();\n      resolved.add(part);\n    }\n    return this.render(importPromise, value);\n  }\n\n  render(_importPromise: () => Promise<void>, value: () => TemplateResult) {\n    return value();\n  }\n}\n\nexport const lazyLoadTemplate = directive(LazyLoadTemplate);\n"]}